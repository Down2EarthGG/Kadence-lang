note: Test utilities for Kadence

let term = run require "./console.js"
let testHelpers = run require "./test-helpers.js"

export function suite name callback
    echo "Suite: " plus name
    if callback not equals undefined
        run callback
    end
    return true
end

export function assertEquals actual expected message
    if actual equals expected
        let colored = run term.green "PASS"
        echo colored plus ": " plus message
        return true
    else
        let colored = run term.red "FAIL"
        echo colored plus ": " plus message
        echo "  Expected: " plus expected
        echo "  Actual: " plus actual
        return false
    end
end

export function assertTrue value message
    if value
        let colored = run term.green "PASS"
        echo colored plus ": " plus message
        return true
    else
        let colored = run term.red "FAIL"
        echo colored plus ": " plus message
        return false
    end
end

export function assertFalse value message
    if not value
        let colored = run term.green "PASS"
        echo colored plus ": " plus message
        return true
    else
        let colored = run term.red "FAIL"
        echo colored plus ": " plus message
        return false
    end
end

export function assertThrows fn message
    let threw = false
    try
        run fn
    catch e
        set threw to true
    end
    
    if threw
        let colored = run term.green "PASS"
        echo colored plus ": " plus message
        return true
    else
        let colored = run term.red "FAIL"
        echo colored plus ": " plus message
        echo "  Expected function to throw"
        return false
    end
end
